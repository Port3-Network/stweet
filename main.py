import arrow

import stweet as st


def tweets_by_id():
    id_task = st.TweetsByIdTask('1447348840164564994')
    output_json = st.JsonLineFileRawOutput('output_raw_id.jl')
    output_print = st.PrintRawOutput()
    st.TweetsByIdRunner(
        tweets_by_id_task=id_task,
        raw_data_outputs=[output_print, output_json],
    ).run()


def tweets_by_user():
    user_tweets_task = st.TweetsByUserTask('1368057450134310914')
    output_json = st.JsonLineFileRawOutput('output_raw_user_tweets.jl')
    st.TweetsByUserRunner(
        tweets_by_user_task=user_tweets_task,
        raw_data_outputs=[output_json],
    ).run()


def tweets_by_user_proxy():
    user_ids = [
        "1341189064679108609",
        "1350913166314774535",
        "1352194846400806912",
        "1353290982087790592",
        "1353339843623829505",
        "1355915891398090755",
        "1357247019333480449",
        "1358232037077917697",
        "1361737446283767815",
        "1364456394238218240",
        "1364522607333183497",
        "1364610253728276486",
        "1365322797044563969",
        "1365564546925162497",
        "1367140283893223428",
        "1368057450134310914",
        "1370632070926536704",
        "1372865109589037060",
        "1374614898957721601",
        "1376575727424974849",
        "1376614786532802560",
        "1380341547154083844",
        "1381436474449530880",
        "1381838121524895744",
        "1381887284497145864",
        "1382059360130588674",
        "1382209860792512518",
        "1382964481001549824",
        "1383000459376431105",
        "1384138247559778308",
        "1387962317799792642",
        "1387995501157441539",
        "1389853516118716417",
        "1391228372051660803",
        "1391979158872289281",
        "1394317824009506817",
        "1394358450042331136",
        "1394696734601711618",
        "1395068319204470786",
        "1396152572738605066",
        "1397852188097933316",
        "1399188846214991877",
        "1400048113637728257",
        "1400517072572977157",
        "1401238463882596352",
        "1401724157151305729",
        "1402181462145736704",
        "1402741836029046788",
        "1402933150691516416",
        "1408772557508165632",
        "1409435406957940737",
        "1409893840840904706",
        "1409970051562708994",
        "1412390172541423617",
        "1415522287126671363",
        "1417834970207244294",
        "1420357693189988370",
        "1420753176412659713",
        "1421035033721253889",
        "1422023628225396741",
        "1422115451752968196",
        "1423363736484683777",
        "1424655904490745859",
        "1425333538488979457",
        "1426042950509686788",
        "1427134094341677061",
        "1427160102365106182",
        "1427630662266281993",
        "1428623753689243652",
        "1430715563286745089",
        "1430800253142278146",
        "1432675203390316544",
        "1433792622959726598",
        "1434028684948557828",
        "1434498944273293313",
        "1435632291837976580",
        "1436425682318286848",
        "1437041804214370314",
        "1437304481016791041",
        "1437336363641151489",
        "1438766805300940803",
        "1439094074103898115",
        "1441268547406077957",
        "1441967818610597890",
        "1442050075174137856",
        "1442371641627975680",
        "1442437262663319565",
        "1442740341078118401",
        "1442753558311424001",
        "1442761989139271681",
        "1444942144490278918",
        "1445751111793537043",
        "1445842843042451463",
        "1446316025776009216",
        "1448216073862467590",
        "1448593130073198597",
        "1449952015975530502",
        "1450835345482846212",
        "1451036242431262720",
        "1452468408553857026",
        "1453326229478592524",
        "1454218528026886144",
        "1454758102658547713",
        "1454786501116456968",
        "1455052692657631235",
        "1455769485470670851",
        "1456003335933280259",
        "1456194580844474373",
        "1456311379623829508",
        "1456499512273674240",
        "1457552750443593731",
        "1457641571235479553",
        "1458064199201038340",
        "1459046577306173440",
        "1459911341020364806",
        "1460867227809632256",
        "1461454000956579842",
        "1461760828114300933",
        "1462669752648679427",
        "1463082194486784003",
        "1463090487523360772",
        "1464144742091046913",
        "1464520900636815366",
        "1465232295065841664",
        "1465641665977221125",
        "1465876404143198208",
        "1465939427612667906",
        "1466682413459783683",
        "1466688767083876353",
        "1467381934707785728",
        "1467732895725137921",
        "1468129164456779785",
        "1468400038850494464",
        "1468430891957780483",
        "1468637295267893250",
        "1470896356537823233",
        "1471018260200321025",
        "1471529405679816711",
        "1472884459469160448",
        "1473852465619423232",
        "1473924195423637506",
        "1476827585845760001",
        "1477525254150840322",
        "1479029356982906882",
        "1481628541729054722",
        "1481905763249713154",
        "1483025598528503812",
        "1484072387368816640",
        "1484097062904143878",
        "1484752564117979137",
        "1485092941253070855",
        "1485889072774086657",
        "1486312075597164545",
        "1487367901187559424",
        "1488423720767176704",
        "1492512284480094213",
        "1493436075011829761",
        "1493460126962839554",
        "1494533033357381633",
        "1495634119073894400",
        "1496143277367648257",
        "1498211902790717441",
        "1498908525279387648",
        "1498914460332740611",
        "1498960399160332289",
        "1499655605904031746",
        "1500040999963619330",
        "1501764178368860163",
        "1502304670961700869",
        "1502680945920520193",
        "1502833551758147588",
        "1503281659713576962",
        "1503512484652666895",
        "1503578765091291137",
        "1503698284103467008",
        "1503953378153357316",
        "1504003268317306880",
        "1504121630582542338",
        "1504137015184474120",
        "1505215836344119300",
        "1505612518328254466",
        "1506112864465031171",
        "1507505380330545154",
        "1508061773722955776",
        "1508285473474502665",
        "1508316476641792002",
        "1508377168820072449",
        "1508684929936556036",
        "1508728288075980803",
        "1509444249854558208",
        "1509709933570568193",
        "1509731193842974724",
        "1510159393005838343",
        "1510499723358076931",
        "1511654363550273536",
        "1511919260070989827",
        "1512032237507661826",
        "1512272751620685830",
        "1512316683674742788",
        "1512347358440222725",
        "1512621583025774597",
        "1513482534331461637",
        "1513491478022000645",
        "1513814942473990144",
        "1515309923294674945",
        "1516615104594251776",
        "1516685780315299840",
        "1516825556712452096",
        "1517427485868126209",
        "1517451726114402305",
        "1518168690524491777",
        "1518252880498724864",
        "1518775597735890944",
        "1518933358893760512",
        "1519233776018419712",
        "1520964687659094016",
        "1521581440936386561",
        "1522464161187262464",
        "1523565522855804928",
        "1523675694873468928",
        "1523852706598686721",
        "1524611233013370881",
        "1525016820625068032",
        "1525895744829460483",
        "1526048164809060353",
        "1526914646753812481",
        "1527181019450707968",
        "1527815779332378624",
        "1527886904749744129",
        "1528230007012634624",
        "1528641957538721792",
        "1529791307803045888",
        "1530971842772496384",
        "1531542660137177088",
        "1531798848078635008",
        "1532278312537448448",
        "1533092435248590849",
        "1533695037242241026",
        "1534115685395099649",
        "1534457251326566401",
        "1535168339156250624",
        "1537144260151099392",
        "1538117870",
        "1538882671752777729",
        "1539136451685801988",
        "1540034288774656000",
        "1540359296923635712",
        "1543849996004769792",
        "1547465203545022464",
        "1547910735187312640",
        "1548932351547215872",
        "1549305385525268481",
        "1549591314190442496",
        "1550010295073943552",
        "1550046181283483648",
        "1551504643955363840",
        "1552969667488219136",
        "1553504181922799625",
        "1553958549230743553",
        "1553991360360853504",
        "1554469960633696256",
        "1555097228389552129",
        "1555492125646602240",
        "1557647992987209730",
        "1557682209909526528",
        "1559121718358196225",
        "1560553470012362754",
        "1560594887153594369",
        "1561606996197261312",
        "1562350209895518209",
        "1562587593656610820",
        "1563809500674478081",
        "1564430298913263616",
        "1565294616672292865",
        "1565718963505725440",
        "1566063745394438146",
        "1566383409144156160",
        "1566991792754794497",
        "1567147131546501122",
        "1567857806690353152",
        "1568297827666743302",
        "1569936578054868992",
        "1570393307724791809",
        "1571035810807578626",
        "1571780006560542721",
        "1571874754302451712",
        "1572183856949923844",
        "1572443912156880897",
        "1572720029958823936",
        "1572949809404805120",
        "1572997039079624705",
        "1573142662181359616",
        "1574088977136885761",
        "1574291296055099392",
        "1574652435162800128",
        "1576605048662118402",
        "1577084837545971712",
        "1579325980925054976",
        "1580324383935053828",
        "1580478801636532225",
        "1581201101457883136",
        "1581631787112898560",
        "1582285996993163264",
        "1583045959730139136",
        "1583493068111634432",
        "1583996191263510530",
        "1584322942397075456",
        "1585557844908462080",
        "1585907541988368384",
        "1586636688805474304",
        "1586959027401265153",
        "1587070974713028608",
        "1587433015679950849",
        "1588374779056115712",
        "1588968865798946817",
        "1590510024354562048",
        "1592333071528824833",
        "1592420919984918528",
        "1592422063523758080",
        "1592843216839069696",
        "1593127918594822145",
        "1593162341658808320",
        "1594354299823591425",
        "1594640370805182467",
        "1595302361672474625",
        "1595653275503587329",
        "1596181470095511552",
        "1597072913521586177",
        "1597078559511613440",
        "1597252958433021958",
        "1597323929017880577",
        "1597655431996145664",
        "1597880442115395586",
        "1600696140038545409",
        "1601095451096514560",
        "1602113171476852736",
        "1602285735616294912",
        "1602519159518420992",
        "1604771936730775552",
        "1604819713623674880",
        "1607744866636926977",
        "1608466065201442817",
        "1609192696639328258",
        "1609545829886595075",
        "1611324963365191680",
        "1611451328366104577",
        "1615055482854510598",
        "1615238618301501440",
        "1615270425881366528",
        "1617488178696577024",
        "1619540020293169154",
        "1619778968298684416",
        "1620353596096409602",
        "1620414074654965761",
        "1620543885155131392",
        "1621414867902107648",
        "1627554009665118208",
        "1627587846990340096",
        "1627679703065841666",
        "179858385",
        "183631075",
        "2350802640",
        "262983189",
        "2736518930",
        "2790125360",
        "2817995382",
        "2892377910",
        "2929806554",
        "2976283396",
        "309572437",
        "340082215",
        "362590333",
        "386191563",
        "467237184",
        "537826433",
        "575957850",
        "739990548136628224",
        "857890054525652992",
        "858555452862287872",
        "873944102680776704",
        "897836587978956800",
        "903865131301568512",
        "913701352076869632",
        "917505648828465153",
        "937584205566959616",
        "944255537121656833",
        "981381606513487872",
        "984117658202226689",
        "994049301025144832"
    ]

    web_client = st.DefaultTwitterWebClientProvider.get_web_client_preconfigured_for_tor_proxy(
        socks_proxy_url='socks5://localhost:9050',
        control_host='localhost',
        control_port=9051,
        control_password='port3'
    )
    for user_id in user_ids:
        user_tweets_task = st.TweetsByUserTask(user_id)
        output_json = st.JsonLineFileRawOutput(user_id + '.jl')
        output_print = st.PrintRawOutput()
        st.TweetsByUserRunner(
            tweets_by_user_task=user_tweets_task,
            raw_data_outputs=[output_print, output_json],
            web_client=web_client,
        ).run()


if __name__ == '__main__':
    tweets_by_user()
